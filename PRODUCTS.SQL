CREATE DATABASE PRODUCT_DETAILS;

USE PRODUCT_DETAILS;

CREATE TABLE PRODUCT_DETAILS(
PRODUCT_ID INT PRIMARY KEY,
PRODUCT_NAME VARCHAR(200),
PRODUCT_PRICE INT,
PRODUCT_CODE VARCHAR(100),
COMPANY_NAME VARCHAR(50),
VALIDITY INT,
PRODUCT_DISCOUNT DOUBLE,
RATINGS DOUBLE,
PRODUCT_MANUFACTURINGDATE DATE,
EXPERINGDATE DATE);

INSERT INTO PRODUCT_DETAILS VALUES(1,'POUNDS',100,'PON123','POUNDS',6,2.0,4.0,'2023-09-04','2024-01-12'),
(2,'PERFUMES',250,'PER234','PERFUMES',7,10.0,5.0,'2022-11-23','2024-05-10'),
(3,'CREAMS',150,'BAT230','CREAMS',4,50.0,3.0,'2021-11-23','2023-05-20'),
(4,'LIPSTICS',50,'LI567','XXX',9,0.20,3.0,'2023-1-23','2023-06-10'),
(5,'BASMATIRICE',1500,'CODE123','MAX',7,20.0,6.0,'2021-12-13','2024-05-25'),
(6,'FACEWASH',200,'FACE234','FACEWASH',9,10.0,5.0,'2023-09-23','2024-05-20'),
(7,'VICKS',45,'VIC134','VICKS',6,0.05,2.0,'2022-11-23','2025-08-20'),
(8,'JUICE',60,'COC123','JUICE',3,0.05,2.0,'2023-1-23','2025-08-26'),
(9,'MAGGU',70,'MAG456','MAGGI',6,0.03,4.0,'2021-11-23','2023-08-20'),
(10,'FOGHE',300,'FOG134','PERFUMES',5,10.0,5.0,'2020-12-03','2025-03-22');

SELECT * FROM PRODUCT_DETAILS;

DELETE FROM PRODUCT_DETAILS WHERE PRODUCT_ID=10;

SELECT * FROM PRODUCT_DETAILS WHERE PRODUCT_NAME LIKE 'C%';

SELECT * FROM PRODUCT_DETAILS WHERE PRODUCT_NAME LIKE '%H';

SELECT * FROM PRODUCT_DETAILS WHERE PRODUCT_NAME LIKE '___R%';

SELECT MIN(PRODUCT_PRICE) FROM PRODUCT_DETAILS;

SELECT MAX(PRODUCT_PRICE) FROM PRODUCT_DETAILS;

SELECT AVG(PRODUCT_PRICE) FROM PRODUCT_DETAILS;

SELECT MIN(PRODUCT_PRICE) FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE >
 (SELECT MIN(PRODUCT_PRICE) FROM PRODUCT_DETAILS);

SELECT MAX(PRODUCT_PRICE) FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE <
(SELECT MAX(PRODUCT_PRICE) FROM PRODUCT_DETAILS);

SELECT PRODUCT_PRICE FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE >
(SELECT AVG(PRODUCT_PRICE) FROM PRODUCT_DETAILS);

SELECT PRODUCT_PRICE FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE <
(SELECT AVG(PRODUCT_PRICE) FROM PRODUCT_DETAILS);

SELECT * FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE BETWEEN 45 AND 200;

SELECT * FROM PRODUCT_DETAILS WHERE PRODUCT_NAME='CREAMS' OR PRODUCT_NAME='PERFUMES';

SELECT * FROM PRODUCT_DETAILS WHERE PRODUCT_NAME IN ('POUNDS');


CREATE VIEW PRODUCT_INFO AS SELECT PRODUCT_NAME FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE=1500;

SELECT *  FROM PRODUCT_INFO;

RENAME TABLE PRODUCT_INFO TO PRODUCT_INFOMATION;

SELECT * FROM PRODUCT_INFOMATION;

ALTER VIEW PRODUCT_INFOMATION AS SELECT COUNT(*)
 AS PRODUCT_CODE,PRODUCT_NAME FROM PRODUCT_DETAILS GROUP BY PRODUCT_NAME;

SELECT PRODUCT_NAME FROM PRODUCT_DETAILS WHERE   EXISTS
( SELECT PRODUCT_PRICE FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE=45);

SELECT PRODUCT_NAME FROM PRODUCT_DETAILS WHERE   NOT EXISTS
( SELECT PRODUCT_PRICE FROM PRODUCT_DETAILS WHERE PRODUCT_PRICE=45);

SELECT VALIDITY FROM PRODUCT_DETAILS GROUP BY VALIDITY;

SELECT COUNT(PRODUCT_ID),VALIDITY FROM PRODUCT_DETAILS GROUP BY VALIDITY;








